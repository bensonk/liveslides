<head>
  <title>liveslides</title>
</head>

<body>
  {{> content}}
</body>

<template name="content">
  {{#if has_show}}
    {{#if auth_page}}
      {{> auth}}
    {{else}}
      {{> slide_list}}
      {{> current_slide}}
    {{/if}}
  {{else}}
    {{> slideshows}}
  {{/if}}
</template>
<template name="auth">
  <div>
    {{#if has_passcode}}
      <h1> {{passcode}}</h1>
      <span>You will need to enter this code in the future in order to edit slides.</span>
      <span>Someday meteor will have auth working for real, this is just a temporary thing.</span>
    {{else}}
      <span> Please enter your passcode to edit the show</span>
      <input id='auth_input' placeholder='purple-monkeyshit' />
      <input id='auth_submit' type='button' value='submit' />
    {{/if}}
  </div>
</template>
<template name="slideshows">
  <div id='all_shows'>
    <div id='new_show'>
      <button class='button big'>New Slideshow</button>
    </div>
    {{#each shows}}
      {{> show}}
    {{/each}}
  </div>
</template>
<template name="show">
  <div class='slideshow'>
    <span id='slide-title'>
      {{title}}
    </span>
    <span class='summary'>
      {{#markdown}}{{summary}}{{/markdown}}
    </span>
  </div>
</template>
<template name="slide_list">
  <div id="index">
    <h3>Slides</h3>
    <ul>
      <li>
        <span class='order'> 0 </span>
        <span id='show-title'>
          {{show_title}}
        </span>
      </li>
      {{#each slides}}
      <li class="slide-entry{{is_current}}{{is_client_current}}{{is_future}}" id="{{_id}}">
        {{#if admin}}
        <span class='admin-control'>
          <a href="#" class="admin-prev"><img src="/images/arrow_up.png" /></a>
          <a href="#" class="admin-next"><img src="/images/arrow_down.png" /></a>
          <a href="#" class="admin-delete"><img src="/images/delete.png" /></a>
        </span>
        {{/if}}
        <span class='order'>
          {{order}}
        </span>
        <span class='title'>
          {{title}}
        </span>
      </li>
      {{/each}}
    </ul>
    {{#if admin}}
      <a href="#" id="new-slide">another!</a>
    {{/if}}
  </div>
</template>

<template name="current_slide">
  {{#if slide}}
  {{#with slide}}
  <div id="main-slide">
    <div class="slide">
      <h1 id="slide-title">{{title}}</h1>
      <div id="slide-body">
        {{#if editing_body}}
          {{> edit_body}}
        {{else}}
          {{#markdown}}{{{body}}}{{/markdown}}
        {{/if}}
      </div>
    </div>
  </div>
  {{prettify}}
  {{/with}}
  {{/if}}
</template>

<template name="edit_body">
  <div><textarea rows="25" cols="80" id="body-box">{{body}}</textarea></div>
</template>

<template name="edit_slide">
  <div id="edit-slide">
    <div><input type="text" id="title-box" value="{{title}}" /></div>
    <div><textarea rows="25" cols="80" id="body-box">{{body}}</textarea></div>
  </div>
</template>
